# コア機能設計：依存数・非依存数・不安定度の算出

## 目的

- 依存グラフから各ノード（構造体・インターフェース・関数）の「依存数」「非依存数」を算出し、  
  それをもとに不安定度（変更容易度）指標を計算する。

---

## 要件

- 依存グラフ（ノード・エッジ情報）を入力とする
- 各ノードについて
    - **依存数（出次数）**：そのノードが依存している他ノードの数
    - **非依存数（入次数）**：そのノードが他ノードから依存されている数
- 不安定度指標（I = 依存数 / (依存数 + 非依存数)）を算出
    - 依存数＋非依存数が0の場合は不安定度を1.0（最大）とする
- 算出結果はノード情報に付加し、可視化・出力で利用できるようにする

---

## 入力

- 依存グラフ（DependencyGraph）

---

## 出力

- 各ノードの依存数・非依存数・不安定度を付加したデータ構造

---

## 主な処理フロー

1. **依存数（出次数）の算出**
    - 各ノードから出ているエッジ数をカウント

2. **非依存数（入次数）の算出**
    - 各ノードに入っているエッジ数をカウント

3. **不安定度の算出**
    - I = 依存数 / (依存数 + 非依存数)
    - 依存数＋非依存数が0の場合はI=1.0

4. **ノード情報への付加**
    - 各ノードに依存数・非依存数・不安定度を格納

---

## 想定データ構造（例：stability.go）

```go
type NodeStability struct {
    NodeID         NodeID
    OutDegree      int // 依存数
    InDegree       int // 非依存数
    Instability    float64 // 不安定度（変更容易度）
}

type StabilityResult struct {
    NodeStabilities map[NodeID]*NodeStability
}
```

---

## 拡張ポイント

- 不安定度指標の定義を柔軟に切り替えられるようにする
- 依存関係の種類ごとに重み付けを行う
- パッケージ単位での集約・可視化 

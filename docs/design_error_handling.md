# エラーハンドリング設計

## 目的

- 解析処理中に発生する様々なエラーを適切に処理し、ユーザーに分かりやすいエラーメッセージを提供する
- 部分的なエラーがあっても可能な限り処理を継続し、有用な結果を返す

---

## 要件

- ファイル読み込みエラー、パースエラーなど様々なエラーを分類して処理
- エラーを収集し、まとめて報告する機能
- エラーがあっても部分的な結果を返す柔軟性
- 構造化ログによるエラー情報の記録

---

## エラー種別

### 1. AnalysisError
- 解析処理全般で発生するエラー
- ファイルパスとエラー原因を保持
- ディレクトリアクセスエラー、ファイル読み込みエラーなど

### 2. ParseError
- Goファイルのパースエラー
- ファイル名、行番号、エラー原因を保持
- 構文エラー、不正なGoコードなど

---

## エラー収集機能

### ErrorCollector
- 複数のエラーを収集する機能
- エラーがあっても処理を継続
- 最終的にまとめてエラー報告

---

## 実装データ構造

```go
// AnalysisError は解析エラーを表す
type AnalysisError struct {
    Path string
    Err  error
}

// ParseError はパースエラーを表す
type ParseError struct {
    File string
    Line int
    Err  error
}

// ErrorCollector はエラーを収集する
type ErrorCollector struct {
    errors []error
}
```

---

## エラー処理フロー

1. **エラー発生時の収集**
   - 各処理でエラーが発生した場合、ErrorCollectorに追加
   - 処理は可能な限り継続

2. **エラーの分類と記録**
   - ログレベルに応じてエラー情報を記録
   - 重大なエラーとワーニングを区別

3. **結果の返却**
   - 部分的な結果でも有用な場合は結果を返す
   - エラー情報も併せて提供

---

## 拡張ポイント

- エラーの重要度による分類
- 復旧可能なエラーの自動処理
- エラー統計情報の提供 
